syntax = "proto3";

package Protocol;
import "google/protobuf/timestamp.proto";
option csharp_namespace = "Google.Protobuf.Protocol";

enum MsgId {
  S_PING = 0;
  C_PONG = 1;
  S_ENTER_GAME = 2;
  S_LEAVE_GAME = 3;
  S_SPAWN = 4;
  S_DESPAWN = 5;
  S_MOVE = 6;
  C_MOVE = 7;
  S_CONNECTED = 8;
  C_LOGIN = 9;
  S_LOGIN = 10;
  C_ENTER_GAME = 11;
  C_CREATE_PLAYER = 12;
  S_CREATE_PLAYER = 13;
  C_CHAT = 14;
  S_CHAT = 15;
  S_ACHIEVEMENT_LIST = 16;
}

enum CreatureState {
  IDLE = 0;
  MOVING = 1;
  SKILL = 2;
  DEAD = 3;
}

enum MoveDir {
  NONE = 0;
  UP = 1;
  DOWN = 2;
  LEFT = 3;
  RIGHT = 4;
}

enum GameObjectType {
  EMPTY = 0;
  PLAYER = 1;
}

enum PlayerServerState {
  SERVER_STATE_LOGIN = 0;
  SERVER_STATE_LOBBY = 1;
  SERVER_STATE_GAME = 2;
}

enum MessageType {
  PRIVATE = 0;	// 귓속말
  PUBLIC = 1;	// 공개 채팅
  SYSTEM = 2;	// 관리자 채팅
}

enum AchievementType {
  ACHIEVEMENT_TYPE_LOCK = 0;
  ACHIEVEMENT_TYPE_UNLOCK = 1;
}

message S_Ping {

}

message C_Pong {

}

message S_EnterGame {
  ObjectInfo player = 1;
}

message C_EnterGame {
  string name = 1;
  float speed = 2;
}

message S_LeaveGame {

}

message S_Spawn {
  repeated ObjectInfo objects = 1;
}

message S_Despawn {
  repeated int32 objectIds = 1;
}

message S_Move {
  int32 objectId = 1;
  PositionInfo posInfo = 2;
}

message C_Move {
  PositionInfo posInfo = 1;
}

message S_Connected {

}

message C_Login {
  string uniqueId = 1;
}

message S_Login {
  int32 loginOk = 1;
  repeated LobbyPlayerInfo players = 2;
}

message C_CreatePlayer {
  string name = 1;
  float speed = 2;
}

message S_CreatePlayer {
  LobbyPlayerInfo player = 1;
}

message C_Chat {
  MessageType type = 1;
  bool success = 2;
  string msg = 3;
}

message S_Chat {
  MessageType type = 1;
  int32 sender_id = 2;
  string name = 3;
  string msg = 4;
  //int32 timestamp = 4;
}

message S_AchievementList {
  repeated AchievementInfo achievements = 1;
}

message LobbyPlayerInfo {
  int32 playerDbId = 1;
  string name = 2;
  float speed = 3;
}

message ObjectInfo {
  int32 objectId = 1;
  string name = 2;
  PositionInfo posInfo = 3;
}

message PositionInfo {
  CreatureState state = 1;
  MoveDir moveDir = 2;
  float posX = 3;
  float posY = 4;
  float speed = 5;
}

message AchievementInfo {
  int32 AchievementDbId = 1;
  int32 templateId = 2;
  int32 slot = 3;
  string locked = 4;
}